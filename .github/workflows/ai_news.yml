import feedparser
          import requests
          import os

          # 1. å°è¯•æŠ“å–èµ„è®¯ï¼ˆå¦‚æœ The Verge ä¸è¡Œï¼Œå¢åŠ ä¸€ä¸ªå¤‡é€‰æºï¼‰
          urls = [
              "https://www.theverge.com/ai-artificial-intelligence/rss/index.xml",
              "https://www.wired.com/feed/tag/ai/latest/rss"
          ]
          
          all_entries = []
          for url in urls:
              feed = feedparser.parse(url)
              all_entries.extend(feed.entries[:3])

          # 2. å‡†å¤‡å†…å®¹
          if not all_entries:
              final_message = "ğŸ¤– **AI æƒ…æŠ¥å‘˜ï¼š** æš‚æ—¶æ²¡æœ‰å‘ç°æ–°èµ„è®¯ï¼Œæˆ‘ä¼šç»§ç»­ç›‘æ§ã€‚"
          else:
              final_message = "ğŸ¤– **AI è¡Œä¸šæœ€æ–°èµ„è®¯ (è‡ªåŠ¨ç¿»è¯‘)**\n\n"
              for entry in all_entries[:3]: # åªå–å‰3æ¡æœ€ç²¾ç®€çš„
                  title_en = entry.title
                  link = entry.link
                  
                  try:
                      resp = requests.post(
                          "https://api.deepseek.com/chat/completions",
                          headers={"Authorization": f"Bearer {os.environ['AI_API_KEY']}"},
                          json={
                              "model": "deepseek-chat",
                              "messages": [
                                  {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç§‘æŠ€ç¿»è¯‘åŠ©æ‰‹ï¼Œè¯·å°†ä¸‹æ–¹çš„ AI æ–°é—»æ ‡é¢˜ç¿»è¯‘æˆé€šä¿—æ˜“æ‡‚çš„ä¸­æ–‡ï¼Œåªè¿”å›ç¿»è¯‘ç»“æœã€‚"},
                                  {"role": "user", "content": title_en}
                              ]
                          },
                          timeout=15
                      )
                      title_cn = resp.json()['choices'][0]['message']['content']
                  except Exception as e:
                      print(f"ç¿»è¯‘å‡ºé”™: {e}")
                      title_cn = "ï¼ˆç¿»è¯‘å¤±è´¥ï¼‰" + title_en

                  final_message += f"ğŸ”¹ **{title_cn}**\nğŸ”— [æŸ¥çœ‹åŸæ–‡]({link})\n\n"

          # 3. æ¨é€
          r = requests.post(
              os.environ['WECHAT_WEBHOOK'],
              json={"msgtype": "markdown", "markdown": {"content": final_message}}
          )
          print(f"æ¨é€çŠ¶æ€ç : {r.status_code}, å“åº”å†…å®¹: {r.text}")
